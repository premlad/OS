using RSACryptography;
using System;
using System.Configuration;
using System.Data.SqlServerCe;
using System.IO;

namespace OS.Data_Access_Layer
{
	public class CheckDB
	{
		//public SqlCeCommand cmd;
		//public SqlCeConnection con = new SqlCeConnection(ConfigurationManager.ConnectionStrings["CONNECT"].ToString());
		private readonly string _C = ConfigurationManager.ConnectionStrings["CONNECT"].ToString();
		public string path = System.IO.Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().GetName().CodeBase);
		public string TXTPATH = Directory.GetCurrentDirectory() + "\\DBSCRIPTS";
		public string qry = "";
		public string CreateDbForFirstInstance()
		{
			try
			{
				//if (File.Exists("OS.sdf"))
				//{
				//	File.Delete("OS.sdf");
				//	//return "EXISTS";
				//}
				SqlCeEngine en = new SqlCeEngine(_C);
				if (File.Exists("The-PIT-Archive.sdf"))
				{
					//File.Delete("OS.sdf");
					return "EXISTS";
				}
				else
				{
					en.CreateDatabase();

					qry = "CREATE TABLE [M_LOG_AUDIT](	ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	NAME ntext NULL,	OPERATION ntext NULL,	DESCRIPTION ntext NULL,	TID ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL); CREATE TABLE [T_LOGIN] (ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	FULLNAME ntext NULL,	MOBILENO ntext NULL,	EMAIL nchar(100) NULL,	PASSWORD ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	DATEFROM datetime NULL,	DATETO datetime NULL,	ADMIN nchar(10) NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL ); CREATE TABLE [T_INS_COMPANY](ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	COMPANYNAME ntext NULL,	REGOFFICE ntext NULL,	CORPORATEOFFICE ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	CIN ntext NULL,	BSECODE ntext NULL,	NSECODE ntext NULL,	ISIN ntext NULL,	OFFICERNAME ntext NULL,	DESIGNATION ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON ntext NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_COMPANY_LOG](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	COMPANYNAME ntext NULL,	REGOFFICE ntext NULL,	CORPORATEOFFICE ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	CIN ntext NULL,	BSECODE ntext NULL,	NSECODE ntext NULL,	ISIN ntext NULL,	OFFICERNAME ntext NULL,	DESIGNATION ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	CONNECTPERSONID ntext NULL,	EMPNAME ntext NULL,	CURRDESIGNATION ntext NULL,	ADDRESS ntext NULL,	RESIADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	DEMATACNO ntext NULL,	MOBILENO ntext NULL,  EMAILID ntext NULL,	GRADUATIONINSTI ntext NULL,	PASTEMP ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON ntext NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER_DT](ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	PERID int NULL,	NAME ntext NULL,	ADDRESS ntext NULL,	RELATIONSHIP ntext NULL,	MOBILENO ntext NULL,	PANNO ntext NULL,	DEMATACNO ntext NULL,	TYPE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON ntext NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER_DT_LOG] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	PERID int NULL,	NAME ntext NULL,	ADDRESS ntext NULL,	RELATIONSHIP ntext NULL,	MOBILENO ntext NULL,	PANNO ntext NULL,	DEMATACNO ntext NULL,	TYPE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL);CREATE TABLE [T_INS_PER_LOG] (ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	CONNECTPERSONID ntext NULL,	EMPNAME ntext NULL,	CURRDESIGNATION ntext NULL,	ADDRESS ntext NULL,	RESIADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	DEMATACNO ntext NULL,	MOBILENO ntext NULL,  EMAILID ntext NULL,	GRADUATIONINSTI ntext NULL,	PASTEMP ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PRO](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	RECEPIENTID ntext NULL,	NAMEINSIDER ntext NULL,	CATEGORYRECEIPT ntext NULL,	ADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	AADHARNO ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	PANNOAFFILIATES ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON ntext NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PRO_LOG] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	RECEPIENTID ntext NULL,	NAMEINSIDER ntext NULL,	CATEGORYRECEIPT ntext NULL,	ADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	AADHARNO ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	PANNOAFFILIATES ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_UPSI] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	UPSIID ntext NULL,	RECIPIENTNAME ntext NULL,	RECIPIENTCAT ntext NULL,	PANNO ntext NULL,	ADDRESS ntext NULL,	UPSINATURE ntext NULL,	SHARINGPURPOSE ntext NULL,	SHARINGDATE ntext NULL,	EFFECTIVEUPTO ntext NULL,	REMARKS ntext NULL,	NDASIGNED ntext NULL,	UPSIAVAILABLE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON ntext NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_UPSI_LOG](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	UPSIID ntext NULL,	RECIPIENTNAME ntext NULL,	RECIPIENTCAT ntext NULL,	PANNO ntext NULL,	ADDRESS ntext NULL,	UPSINATURE ntext NULL,	SHARINGPURPOSE ntext NULL,	SHARINGDATE ntext NULL,	EFFECTIVEUPTO ntext NULL,	REMARKS ntext NULL,	NDASIGNED ntext NULL,	UPSIAVAILABLE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); INSERT INTO T_LOGIN (FULLNAME,MOBILENO,EMAIL,PASSWORD,ENTEREDBY,ENTEREDON,ADMIN ,ACTIVE ,LOCK) VALUES('" + CryptographyHelper.Encrypt("Admin") + "','" + CryptographyHelper.Encrypt("9619626541") + "','admin','" + CryptographyHelper.Encrypt("PiTArc@$961@") + "',NULL,NULL,'Y','Y','N')  ";

					//qry = "CREATE TABLE [M_LOG_AUDIT](	ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	NAME ntext NULL,	OPERATION ntext NULL,	DESCRIPTION ntext NULL,	TID ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL); CREATE TABLE [T_LOGIN] (ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	FULLNAME ntext NULL,	MOBILENO ntext NULL,	EMAIL nchar(100) NULL,	PASSWORD ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	DATEFROM ntext NULL,	DATETO ntext NULL,	ADMIN nchar(10) NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL ); CREATE TABLE [T_INS_COMPANY](ID int IDENTITY(1,1) PRIMARY KEY NOT NULL,	COMPANYNAME ntext NULL,	REGOFFICE ntext NULL,	CORPORATEOFFICE ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	CIN ntext NULL,	BSECODE ntext NULL,	NSECODE ntext NULL,	ISIN ntext NULL,	OFFICERNAME ntext NULL,	DESIGNATION ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON datetime NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_COMPANY_LOG](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	COMPANYNAME ntext NULL,	REGOFFICE ntext NULL,	CORPORATEOFFICE ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	CIN ntext NULL,	BSECODE ntext NULL,	NSECODE ntext NULL,	ISIN ntext NULL,	OFFICERNAME ntext NULL,	DESIGNATION ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	CONNECTPERSONID ntext NULL,	EMPNAME ntext NULL,	CURRDESIGNATION ntext NULL,	ADDRESS ntext NULL,	RESIADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	DEMATACNO ntext NULL,	MOBILENO ntext NULL,  EMAILID ntext NULL,	GRADUATIONINSTI ntext NULL,	PASTEMP ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON datetime NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER_DT](ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	PERID int NULL,	NAME ntext NULL,	ADDRESS ntext NULL,	RELATIONSHIP ntext NULL,	MOBILENO ntext NULL,	PANNO ntext NULL,	DEMATACNO ntext NULL,	TYPE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON datetime NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PER_DT_LOG] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	PERID int NULL,	NAME ntext NULL,	ADDRESS ntext NULL,	RELATIONSHIP ntext NULL,	MOBILENO ntext NULL,	PANNO ntext NULL,	DEMATACNO ntext NULL,	TYPE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL);CREATE TABLE [T_INS_PER_LOG] (ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	CONNECTPERSONID ntext NULL,	EMPNAME ntext NULL,	CURRDESIGNATION ntext NULL,	ADDRESS ntext NULL,	RESIADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	DEMATACNO ntext NULL,	MOBILENO ntext NULL,  EMAILID ntext NULL,	GRADUATIONINSTI ntext NULL,	PASTEMP ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PRO](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	RECEPIENTID ntext NULL,	NAMEINSIDER ntext NULL,	CATEGORYRECEIPT ntext NULL,	ADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	AADHARNO ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	PANNOAFFILIATES ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON datetime NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_PRO_LOG] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	RECEPIENTID ntext NULL,	NAMEINSIDER ntext NULL,	CATEGORYRECEIPT ntext NULL,	ADDRESS ntext NULL,	PANNO ntext NULL,	OTHERIDENTIFIER ntext NULL,	AADHARNO ntext NULL,	MOBILENO ntext NULL,	LANDLINENO ntext NULL,	EMAILID ntext NULL,	PANNOAFFILIATES ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_UPSI] (	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	UPSIID ntext NULL,	RECIPIENTNAME ntext NULL,	RECIPIENTCAT ntext NULL,	PANNO ntext NULL,	ADDRESS ntext NULL,	UPSINATURE ntext NULL,	SHARINGPURPOSE ntext NULL,	SHARINGDATE ntext NULL,	EFFECTIVEUPTO ntext NULL,	REMARKS ntext NULL,	NDASIGNED ntext NULL,	UPSIAVAILABLE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	MODIFIEDBY ntext NULL,	MODIFIEDON datetime NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); CREATE TABLE [T_INS_UPSI_LOG](	ID int IDENTITY(1, 1) PRIMARY KEY NOT NULL,	TID int NULL,	UPSIID ntext NULL,	RECIPIENTNAME ntext NULL,	RECIPIENTCAT ntext NULL,	PANNO ntext NULL,	ADDRESS ntext NULL,	UPSINATURE ntext NULL,	SHARINGPURPOSE ntext NULL,	SHARINGDATE ntext NULL,	EFFECTIVEUPTO ntext NULL,	REMARKS ntext NULL,	NDASIGNED ntext NULL,	UPSIAVAILABLE ntext NULL,	ENTEREDBY nchar(100) NULL,	ENTEREDON datetime NULL,	OPERATION ntext NULL,	ACTIVE nchar(10) NULL,	LOCK nchar(10) NULL); INSERT INTO T_LOGIN (FULLNAME,MOBILENO,EMAIL,PASSWORD,ENTEREDBY,ENTEREDON,ADMIN ,ACTIVE ,LOCK) VALUES('" + CryptographyHelper.Encrypt("Admin") + "','" + CryptographyHelper.Encrypt("9619626541") + "','admin','" + CryptographyHelper.Encrypt("PTI@321") + "',NULL,NULL,'Y','Y','N')  ";

					string[] a = qry.Split(';');

					for (int i = 0; i < a.Length; i++)
					{
						new MasterClass().executeQueryForDB(a[i]);
					}
					return "EXISTS";
				}
			}
			catch (Exception ex)
			{
				new MasterClass().SAVETEXTLOG(ex);
				throw ex;
			}
		}
	}
}
